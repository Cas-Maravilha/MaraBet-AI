{% extends "base_responsive.html" %}

{% block title %}Dashboard - MaraBet AI{% endblock %}

{% block content %}
<div class="container dashboard">
    
    <!-- Header com sauda√ß√£o -->
    <div class="dashboard-widget-full">
        <div class="card fade-in">
            <div class="card-header">
                <div>
                    <h1 class="card-title">Ol√°, {{ user.name|default('Utilizador') }}! üëã</h1>
                    <p class="text-secondary">
                        <span class="hide-mobile">Bem-vindo ao seu dashboard de apostas inteligentes.</span>
                        <span class="show-mobile">Dashboard</span>
                        <br>
                        <small>{{ current_date|default('25 de Outubro de 2025') }}</small>
                    </p>
                </div>
                <div class="hide-mobile">
                    <button class="btn btn-primary" onclick="refreshDashboard()">
                        üîÑ Atualizar
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Stats Cards -->
    <div class="stat-card fade-in">
        <div class="stat-card-icon" style="background: rgba(26, 115, 232, 0.1); color: var(--primary-color);">
            ‚öΩ
        </div>
        <div class="stat-card-value">{{ total_predictions|default(127) }}</div>
        <div class="stat-card-label">Previs√µes Hoje</div>
        <div class="stat-card-change positive">+15% vs ontem</div>
    </div>
    
    <div class="stat-card fade-in">
        <div class="stat-card-icon" style="background: rgba(52, 168, 83, 0.1); color: var(--success-color);">
            ‚úÖ
        </div>
        <div class="stat-card-value">{{ win_rate|default(73.5) }}%</div>
        <div class="stat-card-label">Taxa de Acerto</div>
        <div class="stat-card-change positive">+2.3% esta semana</div>
    </div>
    
    <div class="stat-card fade-in">
        <div class="stat-card-icon" style="background: rgba(234, 67, 53, 0.1); color: var(--danger-color);">
            üî¥
        </div>
        <div class="stat-card-value">{{ live_matches|default(23) }}</div>
        <div class="stat-card-label">Jogos Ao Vivo</div>
        <div class="stat-card-change">Agora mesmo</div>
    </div>
    
    <div class="stat-card fade-in">
        <div class="stat-card-icon" style="background: rgba(251, 188, 4, 0.1); color: var(--warning-color);">
            üí∞
        </div>
        <div class="stat-card-value">{{ bankroll|default('250.00') }} ‚Ç¨</div>
        <div class="stat-card-label">Bankroll Atual</div>
        <div class="stat-card-change positive">+12.5% este m√™s</div>
    </div>
    
    <!-- Previs√µes em Destaque -->
    <div class="dashboard-widget-full">
        <div class="card fade-in">
            <div class="card-header">
                <h2 class="card-title">‚≠ê Previs√µes em Destaque</h2>
                <a href="/predictions" class="btn btn-outline btn-mobile-full">Ver Todas</a>
            </div>
            <div class="card-body">
                
                <!-- Previs√£o 1 -->
                <div class="prediction-card">
                    <div class="prediction-header">
                        <span class="badge badge-success">Alta Confian√ßa</span>
                        <span class="text-secondary">15:00</span>
                    </div>
                    
                    <div class="prediction-teams">
                        <div class="prediction-team">
                            <img src="/static/images/teams/benfica.png" 
                                 alt="Benfica" 
                                 class="prediction-team-logo"
                                 loading="lazy">
                            <div class="prediction-team-name">Benfica</div>
                        </div>
                        
                        <div class="prediction-vs">vs</div>
                        
                        <div class="prediction-team">
                            <img src="/static/images/teams/porto.png" 
                                 alt="Porto" 
                                 class="prediction-team-logo"
                                 loading="lazy">
                            <div class="prediction-team-name">Porto</div>
                        </div>
                    </div>
                    
                    <div class="prediction-odds">
                        <div class="prediction-odd">
                            <div class="prediction-odd-label">Casa</div>
                            <div class="prediction-odd-value">2.10</div>
                        </div>
                        <div class="prediction-odd" style="background: var(--success-color); color: white;">
                            <div class="prediction-odd-label">Empate</div>
                            <div class="prediction-odd-value">3.40</div>
                        </div>
                        <div class="prediction-odd">
                            <div class="prediction-odd-label">Fora</div>
                            <div class="prediction-odd-value">3.20</div>
                        </div>
                    </div>
                    
                    <div class="prediction-confidence">
                        <span class="text-secondary">Confian√ßa:</span>
                        <div class="prediction-confidence-bar">
                            <div class="prediction-confidence-fill" style="width: 87%;"></div>
                        </div>
                        <span class="font-weight-bold">87%</span>
                    </div>
                    
                    <div style="margin-top: var(--spacing-md);">
                        <button class="btn btn-primary btn-mobile-full">Ver An√°lise Completa</button>
                    </div>
                </div>
                
                <!-- Previs√£o 2 -->
                <div class="prediction-card">
                    <div class="prediction-header">
                        <span class="badge badge-warning">M√©dia Confian√ßa</span>
                        <span class="text-secondary">18:30</span>
                    </div>
                    
                    <div class="prediction-teams">
                        <div class="prediction-team">
                            <img src="/static/images/teams/sporting.png" 
                                 alt="Sporting" 
                                 class="prediction-team-logo"
                                 loading="lazy">
                            <div class="prediction-team-name">Sporting</div>
                        </div>
                        
                        <div class="prediction-vs">vs</div>
                        
                        <div class="prediction-team">
                            <img src="/static/images/teams/braga.png" 
                                 alt="Braga" 
                                 class="prediction-team-logo"
                                 loading="lazy">
                            <div class="prediction-team-name">Braga</div>
                        </div>
                    </div>
                    
                    <div class="prediction-odds">
                        <div class="prediction-odd" style="background: var(--success-color); color: white;">
                            <div class="prediction-odd-label">Casa</div>
                            <div class="prediction-odd-value">1.75</div>
                        </div>
                        <div class="prediction-odd">
                            <div class="prediction-odd-label">Empate</div>
                            <div class="prediction-odd-value">3.60</div>
                        </div>
                        <div class="prediction-odd">
                            <div class="prediction-odd-label">Fora</div>
                            <div class="prediction-odd-value">4.50</div>
                        </div>
                    </div>
                    
                    <div class="prediction-confidence">
                        <span class="text-secondary">Confian√ßa:</span>
                        <div class="prediction-confidence-bar">
                            <div class="prediction-confidence-fill" style="width: 65%;"></div>
                        </div>
                        <span class="font-weight-bold">65%</span>
                    </div>
                    
                    <div style="margin-top: var(--spacing-md);">
                        <button class="btn btn-primary btn-mobile-full">Ver An√°lise Completa</button>
                    </div>
                </div>
                
            </div>
        </div>
    </div>
    
    <!-- Gr√°fico de Performance -->
    <div class="col-lg-8 col-md-6">
        <div class="card fade-in">
            <div class="card-header">
                <h2 class="card-title">üìà Performance Semanal</h2>
                <select class="form-control" style="width: auto;">
                    <option>√öltimos 7 dias</option>
                    <option>√öltimos 30 dias</option>
                    <option>Este m√™s</option>
                </select>
            </div>
            <div class="card-body">
                <canvas id="performanceChart" style="max-height: 300px;"></canvas>
            </div>
        </div>
    </div>
    
    <!-- Estat√≠sticas R√°pidas -->
    <div class="col-lg-4 col-md-6">
        <div class="card fade-in">
            <div class="card-header">
                <h2 class="card-title">üìä Resumo</h2>
            </div>
            <div class="card-body">
                <div class="stat-row">
                    <span class="stat-label">Total de Apostas</span>
                    <span class="stat-value">1,247</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Apostas Ganhas</span>
                    <span class="stat-value text-success">917</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Apostas Perdidas</span>
                    <span class="stat-value text-danger">330</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">ROI M√©dio</span>
                    <span class="stat-value text-success">+15.7%</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Maior Ganho</span>
                    <span class="stat-value">‚Ç¨ 450.00</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Sequ√™ncia Atual</span>
                    <span class="stat-value text-success">7 vit√≥rias</span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Melhores Ligas -->
    <div class="col-lg-6 col-md-6">
        <div class="card fade-in">
            <div class="card-header">
                <h2 class="card-title">üèÜ Melhores Ligas</h2>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Liga</th>
                                <th class="hide-mobile">Jogos</th>
                                <th>Taxa</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td data-label="Liga">
                                    <span class="hide-mobile">üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†Åø</span> Premier League
                                </td>
                                <td data-label="Jogos" class="hide-mobile">87</td>
                                <td data-label="Taxa">
                                    <span class="badge badge-success">78%</span>
                                </td>
                            </tr>
                            <tr>
                                <td data-label="Liga">
                                    <span class="hide-mobile">üá™üá∏</span> La Liga
                                </td>
                                <td data-label="Jogos" class="hide-mobile">92</td>
                                <td data-label="Taxa">
                                    <span class="badge badge-success">75%</span>
                                </td>
                            </tr>
                            <tr>
                                <td data-label="Liga">
                                    <span class="hide-mobile">üá©üá™</span> Bundesliga
                                </td>
                                <td data-label="Jogos" class="hide-mobile">65</td>
                                <td data-label="Taxa">
                                    <span class="badge badge-success">72%</span>
                                </td>
                            </tr>
                            <tr>
                                <td data-label="Liga">
                                    <span class="hide-mobile">üáÆüáπ</span> Serie A
                                </td>
                                <td data-label="Jogos" class="hide-mobile">71</td>
                                <td data-label="Taxa">
                                    <span class="badge badge-warning">68%</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    
    <!-- A√ß√µes R√°pidas -->
    <div class="col-lg-6 col-md-6">
        <div class="card fade-in">
            <div class="card-header">
                <h2 class="card-title">‚ö° A√ß√µes R√°pidas</h2>
            </div>
            <div class="card-body">
                <button class="btn btn-primary btn-mobile-full" style="margin-bottom: var(--spacing-sm);">
                    ‚öΩ Ver Previs√µes de Hoje
                </button>
                <button class="btn btn-secondary btn-mobile-full" style="margin-bottom: var(--spacing-sm);">
                    üî¥ Jogos Ao Vivo
                </button>
                <button class="btn btn-outline btn-mobile-full" style="margin-bottom: var(--spacing-sm);">
                    üí∞ Gerenciar Bankroll
                </button>
                <button class="btn btn-outline btn-mobile-full" style="margin-bottom: var(--spacing-sm);">
                    üìä Relat√≥rios Detalhados
                </button>
            </div>
        </div>
    </div>
    
    <!-- Notifica√ß√µes Recentes -->
    <div class="dashboard-widget-full">
        <div class="card fade-in">
            <div class="card-header">
                <h2 class="card-title">üîî Notifica√ß√µes Recentes</h2>
                <button class="btn btn-outline">Marcar todas como lidas</button>
            </div>
            <div class="card-body">
                <div class="notification-item">
                    <div class="notification-icon" style="background: var(--success-color);">‚úÖ</div>
                    <div class="notification-content">
                        <div class="notification-title">Previs√£o Acertada!</div>
                        <div class="notification-text">Benfica vs Porto - Resultado correto</div>
                        <div class="notification-time">H√° 15 minutos</div>
                    </div>
                </div>
                
                <div class="notification-item">
                    <div class="notification-icon" style="background: var(--primary-color);">üìä</div>
                    <div class="notification-content">
                        <div class="notification-title">Novas Estat√≠sticas</div>
                        <div class="notification-text">Relat√≥rio semanal dispon√≠vel</div>
                        <div class="notification-time">H√° 1 hora</div>
                    </div>
                </div>
                
                <div class="notification-item">
                    <div class="notification-icon" style="background: var(--warning-color);">‚ö†Ô∏è</div>
                    <div class="notification-content">
                        <div class="notification-title">Alerta de Bankroll</div>
                        <div class="notification-text">Considere ajustar tamanho das apostas</div>
                        <div class="notification-time">H√° 3 horas</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
</div>
{% endblock %}

{% block extra_css %}
<style>
.badge {
    display: inline-block;
    padding: 4px 12px;
    border-radius: 12px;
    font-size: 12px;
    font-weight: 500;
}

.badge-success {
    background: rgba(52, 168, 83, 0.1);
    color: var(--success-color);
}

.badge-warning {
    background: rgba(251, 188, 4, 0.1);
    color: var(--warning-color);
}

.badge-danger {
    background: rgba(234, 67, 53, 0.1);
    color: var(--danger-color);
}

.stat-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--spacing-md) 0;
    border-bottom: 1px solid var(--border);
}

.stat-row:last-child {
    border-bottom: none;
}

.stat-label {
    color: var(--text-secondary);
}

.stat-value {
    font-weight: 600;
    color: var(--text-primary);
}

.text-success {
    color: var(--success-color);
}

.text-danger {
    color: var(--danger-color);
}

.notification-item {
    display: flex;
    gap: var(--spacing-md);
    padding: var(--spacing-md);
    border-radius: var(--radius-md);
    margin-bottom: var(--spacing-sm);
    transition: var(--transition-fast);
}

.notification-item:hover {
    background: var(--surface);
}

.notification-icon {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    color: white;
    font-size: 20px;
}

.notification-content {
    flex: 1;
}

.notification-title {
    font-weight: 600;
    margin-bottom: 4px;
}

.notification-text {
    color: var(--text-secondary);
    font-size: 14px;
}

.notification-time {
    color: var(--text-secondary);
    font-size: 12px;
    margin-top: 4px;
}

@media (max-width: 767px) {
    .notification-icon {
        width: 32px;
        height: 32px;
        font-size: 16px;
    }
}
</style>
{% endblock %}

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
<script>
// Performance Chart
const ctx = document.getElementById('performanceChart');
if (ctx) {
    new Chart(ctx, {
        type: 'line',
        data: {
            labels: ['Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'S√°b', 'Dom'],
            datasets: [{
                label: 'Taxa de Acerto (%)',
                data: [68, 72, 75, 71, 76, 78, 73],
                borderColor: '#1a73e8',
                backgroundColor: 'rgba(26, 115, 232, 0.1)',
                tension: 0.4,
                fill: true
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: true,
            plugins: {
                legend: {
                    display: false
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    max: 100
                }
            }
        }
    });
}

// Refresh Dashboard
function refreshDashboard() {
    const overlay = document.getElementById('loading-overlay');
    overlay.style.display = 'flex';
    
    setTimeout(() => {
        overlay.style.display = 'none';
        showToast('‚úÖ Dashboard atualizado', 'success');
    }, 1500);
}

// Toast notification function
function showToast(message, type = 'info') {
    const container = document.getElementById('toast-container');
    const toast = document.createElement('div');
    toast.className = `toast ${type}`;
    toast.textContent = message;
    container.appendChild(toast);
    
    setTimeout(() => {
        toast.remove();
    }, 3000);
}
</script>
{% endblock %}

